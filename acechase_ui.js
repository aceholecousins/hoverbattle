!function(e){function t(t){for(var n,o,c=t[0],a=t[1],h=t[2],u=0,d=[];u<c.length;u++)o=c[u],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&d.push(s[o][0]),s[o]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);for(l&&l(t);d.length;)d.shift()();return i.push.apply(i,h||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,c=1;c<r.length;c++){var a=r[c];0!==s[a]&&(n=!1)}n&&(i.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},s={2:0},i=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var c=window.webpackJsonp=window.webpackJsonp||[],a=c.push.bind(c);c.push=t,c=c.slice();for(var h=0;h<c.length;h++)t(c[h]);var l=a;i.push([74,0]),r()}({11:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(1),s=r(3);class i{constructor(e={}){this.position=n.d.fromValues(0,0,0),this.orientation=n.b.fromValues(0,0,0,1),this.scaling=n.d.fromValues(1,1,1),this.kind=e.kind,Object(s.b)(this,e,["position","orientation","scaling"])}}},15:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(11),s=r(3);class i extends n.a{constructor(e={}){super(e),this.kind="camera",this.nearClip=.1,this.farClip=1e3,this.verticalAngleOfViewInDeg=40,this.onAspectChange=function(e){},Object(s.b)(this,e,["nearClip","farClip","verticalAngleOfViewInDeg"])}}},3:function(e,t,r){"use strict";function n(e,t,r){for(const n of r)e[n]=t[n]}function s(e,t,r){for(const n of r)n in t&&(e[n]=t[n])}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s}))},74:function(e,t,r){"use strict";r.r(t);var n=r(8),s=r(1),i=r(0),o=r(55),c=r(15);let a=new i.tb({canvas:document.getElementById("rendertarget")});var h=r(56);class l extends class{}{constructor(){super(...arguments),this.threeObject=void 0}}const u=new h.a;class d{load(e,t,r){let n=new l;return u.load(e,(function(e){n.threeObject=e.scene,function e(t){"material"in t&&"normalMapType"in t.material&&(t.material.normalMapType=i.S);for(let r of t.children)e(r)}(n.threeObject),void 0!==t&&t()}),void 0,r),n}}var f=r(3);class p{constructor(e,t,r){this.threeScene=e,this.threeObject=t,e.add(t),Object(f.a)(this,r,["kind","position","orientation","scaling"])}set position(e){this.threeObject.position.set(e[0],e[1],e[2])}set orientation(e){this.threeObject.quaternion.set(e[0],e[1],e[2],e[3])}set scaling(e){this.threeObject.scale.set(e[0],e[1],e[2])}remove(){this.threeScene.remove(this.threeObject)}}class b extends p{constructor(e,t){let r=new i.V;super(e,r,t),Object(f.a)(this,t,["nearClip","farClip","verticalAngleOfViewInDeg","onAspectChange"]);const n=()=>{let e=a.domElement.clientWidth/a.domElement.clientHeight;r.aspect=e,r.updateProjectionMatrix(),this.onAspectChange(e)};window.addEventListener("resize",n),n()}set nearClip(e){this.threeObject.near=e,this.threeObject.updateProjectionMatrix()}set farClip(e){this.threeObject.far=e,this.threeObject.updateProjectionMatrix()}set verticalAngleOfViewInDeg(e){this.threeObject.fov=e,this.threeObject.updateProjectionMatrix()}set onAspectChange(e){this._onAspectChange=e,e(this.threeObject.aspect)}get onAspectChange(){return this._onAspectChange}activate(){this.threeScene.userData.activeCamera=this.threeObject}}class _{constructor(e){this.threeScene=e}create(e){return new b(this.threeScene,e)}}class g extends p{constructor(e,t){super(e,new i.W,t),this.color=t.color}set color(e){this.threeObject.color.setRGB(e.r,e.g,e.b)}}class m extends p{constructor(e,t){super(e,new i.p,t),this.groundColor=t.groundColor,this.skyColor=t.skyColor}set groundColor(e){this.threeObject.groundColor.setRGB(e.r,e.g,e.b)}set skyColor(e){this.threeObject.color.setRGB(e.r,e.g,e.b)}}class y{constructor(e){this.threeScene=e}createPointLight(e){return new g(this.threeScene,e)}createHemisphereLight(e){return new m(this.threeScene,e)}}function w(e,t){"mesh"==e.type&&e.material.color.setRGB(t.r,t.g,t.b);for(let r of e.children)w(r,t)}class j extends p{constructor(e,t,r){super(e,t.clone(),r),Object(f.a)(this,r,["baseColor","accentColor"])}set baseColor(e){w(this.threeObject,e)}set accentColor(e){w(this.threeObject,e)}}class v{constructor(e){this.threeScene=e}createFromModel(e){return new j(this.threeScene,e.asset.threeObject.clone(),e)}}class O{constructor(e){this.graphics=e;const t=()=>{a.setSize(a.domElement.clientWidth,a.domElement.clientHeight,!1)};window.addEventListener("resize",t),t()}setSceneOrientation(e){this.graphics.scene.quaternion.set(e[0],e[1],e[2],e[3])}setEnvironment(e){this.graphics.scene.background=e.threeCubemap,this.graphics.scene.environment=e.threePmrem}update(e){a.render(this.graphics.scene,this.graphics.scene.userData.activeCamera)}}class C extends class{}{constructor(){super(...arguments),this.threeCubemap=void 0,this.threePmrem=void 0}}const x=new i.h,k=new i.U(a);k.compileCubemapShader();class R{load(e,t,r){let n=new C;return x.load([e.replace("*","px"),e.replace("*","nx"),e.replace("*","py"),e.replace("*","ny"),e.replace("*","pz"),e.replace("*","nz")],(function(e){let r=k.fromCubemap(e);n.threeCubemap=e,n.threePmrem=r.texture,t()}),void 0,r),n}}class P extends class{}{constructor(){super(...arguments),this.threeObject=void 0}}class M{load(e,t,r){let n=new P,o=(new d).load(e,(function(){if(n.threeObject=o.threeObject,void 0!==t){let e=function(e){let t=[];for(let r of e.children)if(console.log(r),r.name.startsWith("__collision__")){r.updateMatrixWorld();let n=r.geometry.toNonIndexed(),o=(new i.n).fromBufferGeometry(n).vertices;for(let e=0;e<o.length;e+=3){let n=r.localToWorld(o[e]),i=s.c.fromValues(n.x,n.y),c=r.localToWorld(o[e+1]),a=s.c.fromValues(c.x,c.y),h=r.localToWorld(o[e+2]),l=s.c.fromValues(h.x,h.y);t.push([i,a,l])}e.remove(r),r.geometry.dispose()}return t}(o.threeObject);t({boundary:e})}}),r);return n}}let S=new class{constructor(){this.scene=new i.fb,window.scene=this.scene,this.model=new d,this.arena=new M,this.skybox=new R,this.camera=new _(this.scene),this.light=new y(this.scene),this.mesh=new v(this.scene);let e=this.camera.create(new c.a);e.position=s.d.fromValues(0,0,10),e.activate(),e.threeObject.up.set(0,0,1),this.scene.add(e.threeObject);new o.a(e.threeObject,a.domElement).screenSpacePanning=!0,this.control=new O(this)}};var A;A=S,n.a.register(A,"graphicsServer"),requestAnimationFrame((function e(t){requestAnimationFrame(e),S.control.update(t),n.a.sendAll()}))},8:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));window.document,window.document;class n{constructor(e){this.worker=void 0,this.connected=!1,this.sendWhenConnected=!1,this.objectRegistry={},this.localOwnIndexCounter=1,this.localOtherIndexCounter=-1,this.remoteOwnIndexCounter=1,this.remoteOtherIndexCounter=-1,this.msgQueue=[],void 0!==e?(this.worker=new Worker(e),this.worker.onmessage=this.receive.bind(this)):(onmessage=this.receive.bind(this),this.enqueueMsg({kind:"ready"}),this.sendAll(),this.connected=!0)}enqueueMsg(e){this.msgQueue.push(e)}sendAll(){0!=this.msgQueue.length&&(void 0!==this.worker?this.connected?(this.worker.postMessage(this.msgQueue),this.msgQueue=[]):this.sendWhenConnected=!0:(postMessage(this.msgQueue),this.msgQueue=[]))}handleReady(){this.connected=!0,this.sendWhenConnected&&this.sendAll()}handleLinkage(e){let t=this.objectRegistry;for(let r of e.path){let e=t[r];"function"==typeof e&&(e=e.bind(t)),t=e}if("object"!=typeof t&&"function"!=typeof t)throw new Error("tried to link a field which is not an object or a method: "+e.path);this.objectRegistry[this.localOtherIndexCounter--]=t}handleCall(e){let t=this.objectRegistry[e.id](...this.resolveReferences(e.args));"object"==typeof t||"function"==typeof t?this.objectRegistry[this.localOtherIndexCounter--]=t:(void 0!==t&&console.warn("result of remotely called function will be ignored"),this.localOtherIndexCounter--)}handleNew(e){let t=new this.objectRegistry[e.id](...this.resolveReferences(e.args));this.objectRegistry[this.localOtherIndexCounter--]=t}handlePropertySet(e){this.objectRegistry[e.id][e.prop]=this.resolveReferences(e.val)}handleDispose(e){void 0!==this.objectRegistry[e.id].dispose&&this.objectRegistry[e.id].dispose(),delete this.objectRegistry[e.id]}receive(e){for(let t in e.data){let r=e.data[t];switch(r.kind){case"ready":this.handleReady();break;case"link":this.handleLinkage(r);break;case"call":this.handleCall(r);break;case"new":this.handleNew(r);break;case"set":this.handlePropertySet(r);break;case"del":this.handleDispose(r)}}}register(e,t){this.objectRegistry[t]=e}createProxy(e){if(!isNaN(e))throw new Error("numeric indices are reserved for anonymous objects");return this._createProxy(e)}_createProxy(e){let t={},r=this;function n(){return"function"==typeof e&&(r.enqueueMsg({kind:"link",path:e()}),e=r.remoteOtherIndexCounter--),e}function s(){r.enqueueMsg({kind:"del",id:n()}),e=void 0}return new Proxy(Object,{set:(e,t,s)=>(r.enqueueMsg({kind:"set",id:n(),prop:t,val:r.referencifyObject(s)}),!0),get:(i,o,c)=>"__ref__"===o?n():"dispose"===o?s:(o in t||(t[o]=r._createProxy(function(e,t){return function(){return"function"==typeof e?[...e(),t]:[e,t]}}(e,o))),t[o]),apply:(e,t,s)=>(r.enqueueMsg({kind:"call",id:n(),args:r.referencifyObject(s)}),r._createProxy(r.remoteOtherIndexCounter--)),construct:(e,t)=>(r.enqueueMsg({kind:"new",id:n(),args:r.referencifyObject(t)}),r._createProxy(r.remoteOtherIndexCounter--))})}referencifyFunction(e){if(void 0===e.__cb__){0;let t=this.localOwnIndexCounter++;return e.__cb__=t,this.objectRegistry[t]=e,{__cb__:"new"}}return{__cb__:e.__cb__}}referencifyChildren(e){let t=Array.isArray(e)?[]:{};for(let r in e){let n=this.referencifyObject(e[r]);"object"==typeof n&&("__cb__"in n&&(t.__cb__=!0),"__ref__"in n&&(t.__ref__=!0)),t[r]=n}return t}referencifyObject(e){switch(typeof e){case"number":case"string":case"boolean":return e;case"object":return this.referencifyChildren(e);case"function":return void 0===e.__ref__?this.referencifyFunction(e):{__ref__:e.__ref__}}throw new Error("unsendable type: "+typeof e)}resolveReferenceMembers(e){if("__cb__"in e){if("number"==typeof e.__cb__)return this._createProxy(e.__cb__);if("new"===e.__cb__)return this._createProxy(this.remoteOwnIndexCounter++);if(!0===e.__cb__){for(let t in e)e[t]=this.resolveReferences(e[t]);return e}throw new Error("unexpected callback reference type")}if("__ref__"in e){if("number"==typeof e.__ref__||"string"==typeof e.__ref__)return this.objectRegistry[e.__ref__];if(!0===e.__ref__){for(let t in e)e[t]=this.resolveReferences(e[t]);return e}throw new Error("unexpected reference type")}return e}resolveReferences(e){switch(typeof e){case"number":case"string":case"boolean":return e;case"object":return this.resolveReferenceMembers(e)}}}let s;void 0!==window.document?(console.log("loading engine"),s=new n("./acechase_engine.js")):s=new n}});
//# sourceMappingURL=acechase_ui.js.map