!function(e){function t(t){for(var r,s,c=t[0],a=t[1],l=t[2],h=0,d=[];h<c.length;h++)s=c[h],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&d.push(o[s][0]),o[s]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);for(u&&u(t);d.length;)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,c=1;c<n.length;c++){var a=n[c];0!==o[a]&&(r=!1)}r&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},o={2:0},i=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var c=window.webpackJsonp=window.webpackJsonp||[],a=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=a;i.push([74,0]),n()}({11:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1),o=n(3);class i{constructor(e={}){this.position=r.d.fromValues(0,0,0),this.orientation=r.b.fromValues(0,0,0,1),this.scaling=r.d.fromValues(1,1,1),this.kind=e.kind,Object(o.b)(this,e,["position","orientation","scaling"])}}},15:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(11),o=n(3);class i extends r.a{constructor(e={}){super(e),this.kind="camera",this.nearClip=.1,this.farClip=1e3,this.verticalAngleOfViewInDeg=40,this.onAspectChange=function(e){},Object(o.b)(this,e,["nearClip","farClip","verticalAngleOfViewInDeg"])}}},3:function(e,t,n){"use strict";function r(e,t,n){for(const r of n)e[r]=t[r]}function o(e,t,n){for(const r of n)r in t&&(e[r]=t[r])}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},74:function(e,t,n){"use strict";n.r(t);var r=n(8),o=n(1),i=n(0),s=n(55),c=n(15);let a=new i.tb({canvas:document.getElementById("rendertarget")});var l=n(56);class u extends class{}{constructor(){super(...arguments),this.threeObject=void 0}}const h=new l.a;class d{load(e,t,n){let r=new u;return h.load(e,(function(e){r.threeObject=e.scene,function e(t){"material"in t&&"normalMapType"in t.material&&(t.material.normalMapType=i.S);for(let n of t.children)e(n)}(r.threeObject),void 0!==t&&t()}),void 0,n),r}}var f=n(3);class p{constructor(e,t,n){this.threeScene=e,this.threeObject=t,e.add(t),Object(f.a)(this,n,["kind","position","orientation","scaling"])}set position(e){this.threeObject.position.set(e[0],e[1],e[2])}set orientation(e){this.threeObject.quaternion.set(e[0],e[1],e[2],e[3])}set scaling(e){this.threeObject.scale.set(e[0],e[1],e[2])}remove(){this.threeScene.remove(this.threeObject)}}class g extends p{constructor(e,t){let n=new i.V;super(e,n,t),Object(f.a)(this,t,["nearClip","farClip","verticalAngleOfViewInDeg","onAspectChange"]);const r=()=>{let e=a.domElement.clientWidth/a.domElement.clientHeight;n.aspect=e,n.updateProjectionMatrix(),this.onAspectChange(e)};window.addEventListener("resize",r),r()}set nearClip(e){this.threeObject.near=e,this.threeObject.updateProjectionMatrix()}set farClip(e){this.threeObject.far=e,this.threeObject.updateProjectionMatrix()}set verticalAngleOfViewInDeg(e){this.threeObject.fov=e,this.threeObject.updateProjectionMatrix()}set onAspectChange(e){this._onAspectChange=e,e(this.threeObject.aspect)}get onAspectChange(){return this._onAspectChange}activate(){this.threeScene.userData.activeCamera=this.threeObject}}class b{constructor(e){this.threeScene=e}create(e){return new g(this.threeScene,e)}}class _ extends p{constructor(e,t){super(e,new i.W,t),this.color=t.color}set color(e){this.threeObject.color.setRGB(e.r,e.g,e.b)}}class m extends p{constructor(e,t){super(e,new i.p,t),this.groundColor=t.groundColor,this.skyColor=t.skyColor}set groundColor(e){this.threeObject.groundColor.setRGB(e.r,e.g,e.b)}set skyColor(e){this.threeObject.color.setRGB(e.r,e.g,e.b)}}class w{constructor(e){this.threeScene=e}createPointLight(e){return new _(this.threeScene,e)}createHemisphereLight(e){return new m(this.threeScene,e)}}function y(e,t){"mesh"==e.type&&e.material.color.setRGB(t.r,t.g,t.b);for(let n of e.children)y(n,t)}class O extends p{constructor(e,t,n){super(e,t.clone(),n),Object(f.a)(this,n,["baseColor","accentColor"])}set baseColor(e){y(this.threeObject,e)}set accentColor(e){y(this.threeObject,e)}}class v{constructor(e){this.threeScene=e}createFromModel(e){return new O(this.threeScene,e.asset.threeObject.clone(),e)}}class j{constructor(e){this.graphics=e;const t=()=>{a.setSize(a.domElement.clientWidth,a.domElement.clientHeight,!1)};window.addEventListener("resize",t),t()}setSceneOrientation(e){this.graphics.scene.quaternion.set(e[0],e[1],e[2],e[3])}setEnvironment(e){this.graphics.scene.background=e.threeCubemap,this.graphics.scene.environment=e.threePmrem}update(e){a.render(this.graphics.scene,this.graphics.scene.userData.activeCamera)}}class x extends class{}{constructor(){super(...arguments),this.threeCubemap=void 0,this.threePmrem=void 0}}const C=new i.h,k=new i.U(a);k.compileCubemapShader();class P{load(e,t,n){let r=new x;return C.load([e.replace("*","px"),e.replace("*","nx"),e.replace("*","py"),e.replace("*","ny"),e.replace("*","pz"),e.replace("*","nz")],(function(e){let n=k.fromCubemap(e);r.threeCubemap=e,r.threePmrem=n.texture,t()}),void 0,n),r}}class S extends class{}{constructor(){super(...arguments),this.threeObject=void 0}}class I{load(e,t,n){let r=new S,s=(new d).load(e,(function(){if(r.threeObject=s.threeObject,void 0!==t){let e=function(e){let t=[];for(let n of e.children)if(console.log(n),n.name.startsWith("__collision__")){n.updateMatrixWorld();let r=n.geometry.toNonIndexed(),s=(new i.n).fromBufferGeometry(r).vertices;for(let e=0;e<s.length;e+=3){let r=n.localToWorld(s[e]),i=o.c.fromValues(r.x,r.y),c=n.localToWorld(s[e+1]),a=o.c.fromValues(c.x,c.y),l=n.localToWorld(s[e+2]),u=o.c.fromValues(l.x,l.y);t.push([i,a,u])}e.remove(n),n.geometry.dispose()}return t}(s.threeObject);t({boundary:e})}}),n);return r}}let M=new class{constructor(){this.scene=new i.fb,window.scene=this.scene,this.model=new d,this.arena=new I,this.skybox=new P,this.camera=new b(this.scene),this.light=new w(this.scene),this.mesh=new v(this.scene);let e=this.camera.create(new c.a);e.position=o.d.fromValues(0,0,10),e.activate(),e.threeObject.up.set(0,0,1),this.scene.add(e.threeObject);new s.a(e.threeObject,a.domElement).screenSpacePanning=!0,this.control=new j(this)}};var R;R=M,r.a.register(R,"graphicsServer"),requestAnimationFrame((function e(t){requestAnimationFrame(e),M.control.update(t),r.a.sendAll()}))},8:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));"undefined"!=typeof window&&window;function r(...e){0}function o(e,t){r(JSON.stringify("function"==typeof t?t():t));let n={};function s(){return"function"==typeof t&&(r(e.remoteOtherIndexCounter,JSON.stringify(t())),e.enqueueMsg({kind:"link",path:t()}),t=e.remoteOtherIndexCounter--),t}function c(){e.enqueueMsg({kind:"del",id:s()}),t=void 0}return new Proxy(Object,{set:(t,n,r)=>(e.enqueueMsg({kind:"set",id:s(),prop:n,val:i(e,r)}),!0),get(r,i,a){if("then"!==i)return"__ref__"===i?s():"dispose"===i?c:(i in n||(n[i]=o(e,function(e,t){return function(){return"function"==typeof e?[...e(),t]:[e,t]}}(t,i))),n[i])},apply:(t,n,c)=>(e.enqueueMsg({kind:"call",id:s(),args:i(e,c)}),r(s(),e.remoteOtherIndexCounter),o(e,e.remoteOtherIndexCounter--)),construct:(t,n)=>(e.enqueueMsg({kind:"new",id:s(),args:i(e,n)}),r(s(),e.remoteOtherIndexCounter),o(e,e.remoteOtherIndexCounter--))})}function i(e,t){switch(typeof t){case"number":case"string":case"boolean":return t;case"object":return function(e,t){let n=Array.isArray(t)?[]:{};for(let r in t){let o=i(e,t[r]);"object"==typeof o&&("__cb__"in o&&(n.__cb__=!0),"__ref__"in o&&(n.__ref__=!0)),n[r]=o}return n}(e,t);case"function":return void 0===t.__ref__?function(e,t){if(void 0===t.__cb__){r(e.localOwnIndexCounter),r();let n=e.localOwnIndexCounter++;return t.__cb__=n,e.localRegistry[n]=t,{__cb__:"new"}}return{__cb__:t.__cb__}}(e,t):{__ref__:t.__ref__}}throw new Error("unsendable type: "+typeof t)}function s(e,t){switch(typeof t){case"number":case"string":case"boolean":return t;case"object":return function(e,t){if("__cb__"in t){if("number"==typeof t.__cb__)return o(e,t.__cb__);if("new"===t.__cb__)return r(e.remoteOwnIndexCounter),o(e,e.remoteOwnIndexCounter++);if(!0===t.__cb__){for(let n in t)t[n]=s(e,t[n]);return t}throw new Error("unexpected callback reference type")}if("__ref__"in t){if("number"==typeof t.__ref__||"string"==typeof t.__ref__)return e.localRegistry[t.__ref__];if(!0===t.__ref__){for(let n in t)t[n]=s(e,t[n]);return t}throw new Error("unexpected reference type")}return t}(e,t)}}function c(e,t){switch(t.kind){case"ready":!function(e){e.connected=!0,e.sendWhenConnected&&e.sendAll()}(e);break;case"reg":!function(e,t){if(e.remoteRegistry.add(t.id),t.id in e.pendingProxies)for(let n of e.pendingProxies[t.id])n()}(e,t);break;case"link":!function(e,t){let n=e.localRegistry;for(let e of t.path){let t=n[e];"function"==typeof t&&(t=t.bind(n)),n=t}if("object"!=typeof n&&"function"!=typeof n)throw new Error("tried to link a field which is not an object or a method: "+t.path);0;e.localRegistry[e.localOtherIndexCounter--]=n}(e,t);break;case"call":!function(e,t){let n=e.localRegistry[t.id](...s(e,t.args));"object"==typeof n||"function"==typeof n?e.localRegistry[e.localOtherIndexCounter--]=n:(void 0!==n&&console.warn("result of remotely called function will be ignored"),e.localOtherIndexCounter--)}(e,t);break;case"new":!function(e,t){let n=new e.localRegistry[t.id](...s(e,t.args));0;e.localRegistry[e.localOtherIndexCounter--]=n}(e,t);break;case"set":!function(e,t){e.localRegistry[t.id][t.prop]=s(e,t.val)}(e,t);break;case"del":!function(e,t){void 0!==e.localRegistry[t.id].dispose&&e.localRegistry[t.id].dispose();delete e.localRegistry[t.id]}(e,t)}}var a=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((r=r.apply(e,t||[])).next())}))};class l{constructor(e){this.worker=void 0,this.connected=!1,this.sendWhenConnected=!1,this.localRegistry={},this.remoteRegistry=new Set,this.pendingProxies={},this.localOwnIndexCounter=1,this.localOtherIndexCounter=-1,this.remoteOwnIndexCounter=1,this.remoteOtherIndexCounter=-1,this.msgQueue=[],void 0!==e?(this.worker=new Worker(e),this.worker.onmessage=this.receive.bind(this)):(onmessage=this.receive.bind(this),this.enqueueMsg({kind:"ready"}),this.sendAll(),this.connected=!0)}enqueueMsg(e){this.msgQueue.push(e)}sendAll(){if(0!=this.msgQueue.length){r();for(let e of this.msgQueue)r(JSON.stringify(e));void 0!==this.worker?this.connected?(this.worker.postMessage(this.msgQueue),this.msgQueue=[]):this.sendWhenConnected=!0:(postMessage(this.msgQueue),this.msgQueue=[])}}receive(e){for(let t in e.data){let n=e.data[t];r(),r(),c(this,n)}}register(e,t){r(),this.localRegistry[t]=e,this.enqueueMsg({kind:"reg",id:t})}createProxy(e){return a(this,void 0,void 0,(function*(){if(!isNaN(e))throw new Error("numeric indices are reserved for anonymous objects");if(e in this.remoteRegistry)return o(this,e);{let t=this;return new Promise((function(n){e in t.pendingProxies||(t.pendingProxies[e]=[]),t.pendingProxies[e].push((function(){n(o(t,e))}))}))}}))}}let u;void 0!==window.document?(console.log("loading engine"),u=new l("./acechase_engine.js")):u=new l}});
//# sourceMappingURL=acechase_ui.js.map